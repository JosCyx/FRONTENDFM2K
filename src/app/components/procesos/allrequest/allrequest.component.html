<app-menu></app-menu>
<div class="container">
    <h2 class="font-weight-bolt ruteo">Todas las solicitudes</h2>
    <div class="">
        <nav class="navbar navbar-expand-lg navbar-light bg-light">
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <button class="btn btn-primary m-2" (click)="changeView('consultar')">Consultar</button>
                    <button class="btn btn-primary m-2" (click)="changeView('editar')">Editar</button>
                </div>
            </div>
        </nav>
    </div>

    <div class="formRol" *ngIf="changeview === 'consultar'">
        <h3 class="font-weight-bold" style="padding-top: 20pt;">Consultar todas las solicitudes registradas</h3>
    
        <form class="form-tiposol d-flex row mb-5">
          <label class="form-label">Tipo de solicitud</label>
          <div class="form input-group">
            <select class="form-select" name="tipoSol" [(ngModel)]="bsqTipoSol">
              <option disabled selected value=0>Seleccione una opci처n...</option>
              <option *ngFor="let tpsol of tipoSol$ | async" [value]="tpsol.tipoSolId">{{tpsol.tipoSolNombre}}</option>
            </select>
            <button class="btn btn-outline-success" (click)="consultarSol()">Consultar</button>
          </div>
        </form>

        <div class="mb-5">
    
          <table class="table table-bordered table-striped text-center">
            <thead>
              <tr>
                <th>C처digo</th>
                <th>Area solicitante</th>
                <th>N째 Solicitud</th>
                <th>Empleado solicitante</th>
                <th>Asunto</th>
                <th>Fecha</th>
                <th>Estado</th>
                <th>Tracking</th>
              </tr>
            </thead>
            <tbody>
              <tr>
                <td>OB 1-0001</td>
                <td>Obras</td>
                <td>0001</td>
                <td>Moreno Bravo Jose</td>
                <td>Asunto de prueba</td>
                <td>2023-08-09</td>
                <td>Activo</td>
                <td>Emisi처n</td>
              </tr>
              <tr *ngFor="let sol of allSol$ | async">
                <td>{{sol.cabSolCotNumerico}}</td>
                <td>{{sol.cabSolCotArea}}</td>
                <td>{{sol.cabSolCotNoSolicitud}}</td>
                <ng-container *ngFor="let emp of empleadoList$|async">
                  <td class="align-middle" *ngIf="emp.empleadoIdNomina === sol.cabSolCotSolicitante">
                    {{ emp.empleadoNombres + " " + emp.empleadoApellidos }}</td>
                </ng-container>
                <td>{{sol.cabSolCotAsunto}}</td>
                <td>{{sol.cabSolCotFecha | date:'yyyy-MM-dd'}}</td>
                <td>{{sol.cabSolCotEstado}}</td>
                <td>{{sol.cabSolCotEstadoTracking}}</td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>
</div>
