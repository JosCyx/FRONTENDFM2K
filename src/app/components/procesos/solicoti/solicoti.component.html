<app-menu></app-menu>
<div class="container">
    <h2 class="font-weight-bolt ruteo">Solicitud de Cotizacion</h2>
    <div class=" text center">
        <nav class=" navbar-expand-lg navbar-light bg-light" style="height: 30px;">
            <div class="collapse navbar-collapse" id="navbarNavAltMarkup">
                <div class="navbar-nav">
                    <!-- <button class="btn btn-primary m-2" (click)="metodo()">
                        Crear
                    </button>  -->
                </div>
            </div>
        </nav>
    </div>
    <!-- <div class=" m-2 text-center">
        <div *ngIf="showmsj" class="alert alert-success" role="alert">
            <span><i class="bi bi-check-circle-fill"> {{ msjExito }}</i></span>
        </div>
        <div *ngIf="showmsjerror" class="alert alert-danger" role="alert">
            <span><i class="bi bi-exclamation-triangle-fill"> {{ msjError }}</i></span>
        </div>
    </div> -->

    <ng-container *appAuthorize="'25'">
        <div class="form-cot" *ngIf="changeview === 'crear'">
            <h3 class="font-weight-bold" style="padding-top: 20pt">
                Registrar nueva solicitud de cotización
            </h3>

            <div class="tabs-edit">
                <ul class="nav nav-tabs">
                    <li class="nav-item">
                        <a class="nav-link" [ngClass]="{'active': actionCreate === 'creacion'}"
                            (click)="selectCreateAction('creacion')">Creación</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" [ngClass]="{'active': actionCreate === 'proveedores'}" (click)="selectCreateAction('proveedores')
                            ">Proveedores</a>
                    </li>
                    <li class="nav-item">
                        <a class="nav-link" [ngClass]="{'active': actionCreate === 'documentacion'}"
                            (click)="selectCreateAction('documentacion')">Documentación</a>
                    </li>
                </ul>
            </div>


            <div class="solicitud">
                <div class="cabecera mb-3">
                    <div class="custom-input-group mb-1">
                        <label class="custom-label">Fecha:</label>
                        <input type="text" class="custom-input" disabled [(ngModel)]="fechaFormat" />
                    </div>
                    <div class="custom-row mb-1">
                        <div class="custom-input-group ">
                            <label class="custom-label">Solicitado por*:</label>
                            <input type="text" class="custom-input" id="busqueda" list="sugerencias"
                                [(ngModel)]="empleado" (keyup)="searchEmpleado()" (input)="selectEmpleado()"
                                placeholder="Ingrese el nombre del empleado" />

                            <!-- <button class="btn btn-success" (click)="selectEmpleado()">
                                <i class="bi bi-check-lg"></i>
                            </button> -->
                        </div>
                        <datalist id="sugerencias">
                            <ng-container *ngFor="let emp of empleados">
                                <option [value]="emp.empleadoNombres + ' ' + emp.empleadoApellidos"></option>
                            </ng-container>
                        </datalist>
                        <div class="custom-input-group ">
                            <label class="custom-label">Area:</label>
                            <input type="text" class="custom-input" [value]="showArea"
                                placeholder="Area del empleado solicitante" disabled />
                        </div>
                    </div>
                    <div class="custom-input-group mb-1">
                        <label class="custom-label">Asunto*:</label>
                        <input type="text" class="custom-input" maxlength="500" placeholder="Ingrese el asunto"
                            [(ngModel)]="cab_asunto" />
                        <div style="display: flex; flex-direction: row; gap: 5px; align-items: center; justify-content: center;">
                            <div style="background-color: #d6d6d6; border-radius: 5px; padding-right: 10px; margin-left: 5px;">
                                <mat-checkbox color="primary" (change)="checkProyecto($event)" style="font-size: 8pt !important;"
                                    [disabled]="serviceGlobal.solEstado != 10">
                                    <div style="margin-top: 4px;font-style: italic; font-weight: bold; font-size: 10pt;">Proyecto</div>
                                </mat-checkbox>
                            </div>
                            <button *ngIf="isDim" mat-raised-button class="primary-button" style="margin-top: 1px;"
                                (click)="openDimensiones()">Dimensiones</button>
                        </div>
                    </div>
                    <p style="font-style: italic; font-size: 8pt; color: black; font-weight: bold;">Si su solicitud
                        forma parte de un proyecto, por
                        favor seleccione el recuadro "Proyecto" para poder usar las dimensiones asignadas a los
                        proyectos.</p>
                </div>

                <div class="detalle" *ngIf="actionCreate == 'creacion'">
                    <table class="table table-striped text-center">
                        <thead>
                            <tr>
                                <th scope="col">Item</th>
                                <th scope="col">Descripción*</th>

                                <!-- PRESUPUESTO -->
                                <ng-container *ngIf="!isDim">
                                    <th scope="col">Presupuesto*</th>
                                </ng-container>

                                <th scope="col">Sector*</th>
                                <th scope="col">Unidad</th>
                                <th scope="col">Cantidad Total</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr *ngFor="let det of detalleList">
                                <td class="align-middle">{{ det.det_id }}</td>
                                <td class="align-middle">{{ det.det_descp }}</td>

                                <!-- PRESUPUESTO -->
                                <ng-container *ngIf="!isDim">
                                    <ng-container *ngFor="let prep of presupuestosFiltered">
                                        <td class="align-middle" *ngIf="prep.prespId == det.det_presupuesto">{{
                                            prep.prespNombre }}</td>
                                    </ng-container>
                                </ng-container>

                                <td class="align-middle">
                                    <button class="primary-button-outline" data-toggle="modal"
                                        (click)="CapturarIdDetalle(det.det_id)"
                                        data-target="#itemsectorview">Editar</button>
                                </td>
                                <td class="align-middle">{{ det.det_unidad }}</td>
                                <td class="align-middle">
                                    {{ det.det_cantidad }}
                                    <button class="btn text-danger" (click)="deleteDetalle(det.det_id)">
                                        <i class="bi bi-x-circle"></i>
                                    </button>
                                </td>
                            </tr>
                            <tr>
                                <th class="align-middle">{{ det_id }}</th>
                                <td class="align-middle">
                                    <textarea name="descripcion" class="form-control  limited-textarea" rows="2"
                                        cols="50" placeholder="Descripción" [(ngModel)]="det_descp"></textarea>
                                </td>

                                <!-- PRESUPUESTO -->
                                <ng-container *ngIf="!isDim">
                                    <td class="align-middle">

                                        <select class="form-control" [(ngModel)]="det_presupuesto">
                                            <option value="0" selected disabled>presupuesto...</option>
                                            <option *ngFor="let prep of presupuestosFiltered" [value]="prep.prespId">
                                                {{prep.prespNombre}}</option>
                                        </select>
                                    </td>
                                </ng-container>

                                <td class="align-middle">
                                    <button class="primary-button-outline" data-toggle="modal" data-target="#itemsector"
                                        [disabled]="!det_descp">
                                        Desglose
                                    </button>
                                </td>
                                <td class="align-middle" style="width: 150px">
                                    <select class="form-control" [(ngModel)]="det_unidad">
                                        <option value="Unidad" selected>Unidad</option>
                                        <option value="Sacos">Sacos</option>
                                        <option value="Paquete">Paquete</option>
                                        <option value="Avance de Obra">Avance de Obra</option>
                                        <option value="Millar">Millar</option>
                                        <option value="Metros">Metros</option>
                                        <option value="Kilos">Kilos</option>
                                        <option value="Gramos">Gramos</option>
                                        <option value="Caneca">Caneca</option>
                                        <option value="Galon">Galón</option>
                                    </select>
                                </td>
                                <td class="align-middle cel-prep">
                                    <input type="text" class="form-control text-center" [(ngModel)]="det_cantidad"
                                        disabled />
                                </td>
                            </tr>
                            <tr>
                                <td colspan="6" class="align-middle text-end">
                                    <button mat-raised-button class="success-button"
                                        [disabled]="!det_descp || tmpItemSect.length === 0" (click)="addDetalle()">
                                        <i class="bi bi-check"></i>
                                    </button>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>

                <div *ngIf="actionCreate == 'documentacion'">
                    <app-cot-documentacion [view]="changeview" [tipoSol]="sharedTipoSol" [noSol]="sharedNoSol"
                        [estadoSol]="estadoSol"></app-cot-documentacion>
                </div>
                <div *ngIf="actionCreate == 'proveedores'">
                    <app-cot-proveedores [cabSolCotAsunto]="cabSolCotAsunto" [mail_detalles]="sharedDetalle"
                        [tipoSol]="sharedTipoSol" [noSol]="sharedNoSol" [estadoSol]="estadoSol"></app-cot-proveedores>
                </div>

                <div class="foot-cabecera">
                    <!-- <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" [(ngModel)]="cab_proc"
                            placeholder="Materiales y procedimientos a seguir:" />
                        <label for="floatingInput">Materiales y procedimientos a seguir:</label>
                    </div>
                    <div class="form-floating mb-3">
                        <input type="text" class="form-control" id="floatingInput" [(ngModel)]="cab_obsrv"
                            placeholder="Materiales y procedimientos a seguir:" />
                        <label for="floatingInput">Observaciones:</label>
                    </div> -->

                    <div class=" mb-3">
                        <label for="floatingInput" style="color: rgba(0, 0, 0, 0.5);">Materiales y procedimientos a
                            seguir:</label>
                        <textarea style="max-height: 300px;" class="form-control" id="floatingInput" rows="3"
                            [(ngModel)]="cab_proc" [appSecureDisable]="estadoSol" placeholder=""></textarea>
                    </div>
                    <div class=" mb-3">
                        <label for="floatingInput" style="color: rgba(0, 0, 0, 0.5);">Observaciones:</label>
                        <textarea style="max-height: 300px;" class="form-control" id="floatingInput" rows="3"
                            [(ngModel)]="cab_obsrv" [appSecureDisable]="estadoSol" placeholder=""></textarea>
                    </div>

                    <div class="input-group mb-3">
                        <label class="input-group-text">Adjunto cotizaciones:</label>
                        <select class="form-select" [(ngModel)]="cab_adjCot" (change)="setNoSolDocumentacion()">
                            <option value="SI">Sí</option>
                            <option value="NO" selected>No</option>
                        </select>
                        <label class="input-group-text">Número de cotizaciones:</label>
                        <input class="form-select" type="number" (input)="validarNumero($event)" placeholder="Cantidad"
                            min="1" [(ngModel)]="cab_ncot" />
                    </div>
                    <div class="input-group mb-3">
                        <label class="input-group-text">Plazo de entrega*:</label>
                        <input class="form-control" type="date" for="plazoentrega" [(ngModel)]="cab_plazo"
                            (change)="Validacionfecha()" />
                        <label class="input-group-text">Fecha máxima de entrega*:</label>
                        <input class="form-control" type="date" for="fechamaxima" [(ngModel)]="cab_fechaMax" />
                    </div>
                    <div class="input-group">
                        <label class="input-group-text">Inspector:</label>
                        <input type="text" maxlength="100" class="form-control" id="busqueda" list="inspectores"
                            [(ngModel)]="inspector" (keyup)="searchInspector()" (keydown)="verificartexto()"
                            (input)="onInputChanged()" placeholder="Ingrese el nombre del inspector" />
                        <datalist id="inspectores">
                            <ng-container *ngFor="let empOP of inspectores">
                                <option [value]="empOP.empleadoNombres + ' ' + empOP.empleadoApellidos"></option>
                            </ng-container>
                        </datalist>
                        <label class="input-group-text">Teléfono:</label>
                        <input class="form-control" maxlength="15" type="text"
                            placeholder="Ingrese el teléfono del inspector" [(ngModel)]="cab_telef_insp" />
                    </div>
                    <div class="text-end">
                        <p class="tip">*Campos obligatorios</p>
                    </div>
                </div>
            </div>
            <div class="d-flex custom-row">
                <div class="col">
                    <!-- <div *ngIf="showmsj" class="alert alert-success" role="alert">
                        <span><i class="bi bi-check-circle-fill"> {{ msjExito }}</i></span>
                    </div>
                    <div *ngIf="showmsjerror" class="alert alert-danger" role="alert">
                        <span><i class="bi bi-exclamation-triangle-fill"> {{ msjError }}</i></span>
                    </div> -->
                </div>

                <div class="col text-end">
                    <!-- <button mat-raised-button class="primary-button m-2" [disabled]="
                !empleado ||
                !cab_asunto ||
                detalleList.length === 0 ||
                itemSectorList.length === 0 ||
                !serviceGlobal.hasSolDimensiones()" data-toggle="modal" data-target="#guardarCotizacion" *appAuthorize="'25'">
                        Guardar
                    </button>
                    <button mat-raised-button  class="success-button m-2" data-toggle="modal" data-target="#enviarSolicitud" [disabled]="
                !empleado ||
                !cab_asunto ||
                detalleList.length === 0 ||
                itemSectorList.length === 0 ||
                !serviceGlobal.hasSolDimensiones()" *appAuthorize="'27'">
                        Guardar y enviar
                    </button> -->
                    <button mat-raised-button class="primary-button m-2" [disabled]="
                !empleado ||
                !cab_asunto ||
                detalleList.length === 0 ||
                itemSectorList.length === 0" data-toggle="modal" data-target="#guardarCotizacion" *appAuthorize="'25'">
                        Guardar
                    </button>
                    <button mat-raised-button class="success-button m-2" data-toggle="modal"
                        data-target="#enviarSolicitud" [disabled]="
                !empleado ||
                !cab_asunto ||
                detalleList.length === 0 ||
                itemSectorList.length === 0" *appAuthorize="'27'">
                        Guardar y enviar
                    </button>

                    <button mat-raised-button class="danger-button m-2" (click)="cancelarAll()">
                        Cancelar
                    </button>
                </div>
            </div>
        </div>
    </ng-container>

    <ng-container *appAuthorize="'26'">
        <!-- Editar solicitud de cotizacion -->
        <div class="formRol" *ngIf="changeview === 'editar'">
            <ng-container *ngIf="!serviceGlobal.loadingSolicitud">
                <div class="custom-spinner">
                    <mat-spinner></mat-spinner>
                </div>
            </ng-container>
            <ng-container *ngIf="serviceGlobal.loadingSolicitud">

                <h3 class="font-weight-bold" style="padding-top: 20pt">Editar solicitud</h3>

                <div class="tabs-edit">
                    <ul class="nav nav-tabs">
                        <li class="nav-item">
                            <a class="nav-link" [ngClass]="{'active': actionEdit === 'edicion'}"
                                (click)="selectEditAction('edicion')">Edición</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" [ngClass]="{'active': actionEdit === 'proveedores'}"
                                (click)="selectEditAction('proveedores')">Proveedores</a>
                        </li>
                        <li class="nav-item">
                            <a class="nav-link" [ngClass]="{'active': actionEdit === 'documentacion'}"
                                (click)="selectEditAction('documentacion')">Documentación</a>
                        </li>
                        <ng-container
                            *ngIf="cabecera.cabSolCotEstadoTracking > 10 && cabecera.cabSolCotEstadoTracking != 0 && cabecera.cabSolCotEstadoTracking != 9999">
                            <li class="nav-item" *appAuthorize="'53'">
                                <a class="nav-link" [ngClass]="{'active': actionEdit === 'autorizacion'}"
                                    (click)="selectEditAction('autorizacion')">Autorizacion</a>
                            </li>
                        </ng-container>
                    </ul>
                </div>

                <div class="solicitudEdit">
                    <div class="cabecera mb-3">
                        <div class="custom-row mb-1">
                            <div class="custom-input-group ">
                                <label class="custom-label">Código:</label>
                                <input type="text" class="custom-input" [(ngModel)]="cabecera.cabSolCotNumerico"
                                    disabled />
                            </div>
                            <div class="custom-input-group ">
                                <label class="custom-label">Fecha:</label>
                                <input type="text" class="custom-input" [(ngModel)]="cabecera.cabSolCotFecha"
                                    disabled />
                            </div>
                        </div>

                        <div class="custom-row mb-1">
                            <div class="custom-input-group ">
                                <label class="custom-label">Solicitado por:</label>
                                <ng-container *ngFor="let emp of empleadosEdit">
                                    <input *ngIf="emp.empleadoIdNomina == cabecera.cabSolCotSolicitante" type="text"
                                        class="custom-input" id="busqueda" list="sugerencias"
                                        [value]="emp.empleadoNombres + ' ' + emp.empleadoApellidos" disabled />
                                </ng-container>
                            </div>
                            <div class="custom-input-group ">
                                <label class="custom-label">Area:</label>
                                <ng-container *ngFor="let are of areas">
                                    <input *ngIf="are.areaIdNomina == cabecera.cabSolCotIdArea" type="text"
                                        class="custom-input" id="busqueda" list="sugerencias" [value]="are.areaDecp"
                                        disabled />
                                </ng-container>
                            </div>
                        </div>
                        <div class="custom-row mb-1">
                            <div class="custom-input-group ">
                                <label class="custom-label">Tracking:</label>
                                <ng-container *ngFor="let nvTRk of nivelRut$ | async">
                                    <input *ngIf="nvTRk.nivel === cabecera.cabSolCotEstadoTracking" type="text"
                                        class="custom-input" [value]="nvTRk.descRuteo" disabled />
                                </ng-container>
                            </div>
                            <div class="custom-input-group">
                                <label class="custom-label">Estado:</label>
                                <input type="text" class="custom-input" [value]="estadoTexto" disabled />
                            </div>

                        </div>
                        <div class="custom-row mb-1">
                            <!-- <div class="input-group col">
                                <label class="custom-label">Apr. Financiera:</label>
                                <ng-container *ngIf="cabecera.cabSolCotFinancieroBy === 'XXXXXX'; else showValue">
                                    <input type="text" class="form-control" value="Nivel no alcanzado." disabled />
                                </ng-container>
                                <ng-template #showValue>
                                    <ng-container *ngFor="let emp of empleadosEdit">
                                        <input *ngIf="emp.empleadoIdNomina == cabecera.cabSolCotFinancieroBy" type="text"
                                            class="form-control" [value]="emp.empleadoNombres + ' ' + emp.empleadoApellidos"
                                            disabled />
                                    </ng-container>
                                </ng-template>
                            </div> -->
                            <div class="custom-input-group ">
                                <label class="custom-label">Aprobado por:</label>
                                <ng-container *ngIf="cabecera.cabSolCotApprovedBy === 'XXXXXX'; else showValue">
                                    <input type="text" class="custom-input" value="Nivel no alcanzado." disabled />
                                </ng-container>
                                <ng-template #showValue>
                                    <ng-container *ngFor="let emp of empleadosEdit">
                                        <input *ngIf="emp.empleadoIdNomina == cabecera.cabSolCotApprovedBy" type="text"
                                            class="custom-input" id="busqueda"
                                            [value]="emp.empleadoNombres + ' ' + emp.empleadoApellidos" disabled />
                                    </ng-container>
                                </ng-template>
                            </div>

                        </div>
                        <div class=" mb-1">
                            <div class="custom-input-group ">
                                <label class="custom-label">Asunto:</label>
                                <input type="text" class="custom-input" [(ngModel)]="cabecera.cabSolCotAsunto"
                                    [appSecureDisable]="estadoSol" />
                                <button *ngIf="isDim" mat-raised-button class="primary-button" style="margin-left: 5px;"
                                    (click)="openDimensiones()">Dimensiones</button>
                            </div>
                        </div>

                        <div class="custom-input-group mb-1" *ngIf="cabecera.cabSolCotMtovioDev != 'NOHAYMOTIVO'">
                            <label class="custom-label motivo-dev-label">Motivo de devolución:</label>
                            <input type="text" class="custom-input  motivo-dev" [value]="cabecera.cabSolCotMtovioDev"
                                disabled />
                        </div>

                        <!-- <div class="presupuestaria" *ngIf="aprobPreps">
                            <div class="tabs-edit">
                                <ul class="nav nav-tabs">
                                    <li class="nav-item">
                                        <a class="nav-link" style="font-style: italic; font-weight: bold;"
                                            [ngClass]="{'active': 1}">Aprobación presupuestaria</a>
                                    </li>
                                </ul>
                            </div>
                            <div class="row mb-1 align-items-center">
                                <div class="col-md-4">
                                    <div class="input-group">
                                        <label class="custom-label">Aprobación presupuestaria:</label>
                                        <select class="form-select" [(ngModel)]="cabecera.cabSolCotAprobPresup"
                                            [appSecureDisable]="estadoSol" (change)="setMotivoDev()">
                                            <option value="SI">Sí</option>
                                            <option value="NO">No</option>
                                        </select>
                                    </div>
                                </div>
                                <div class="col-md-8">
                                    <div class="input-group" *ngIf="setMotivo == 'SI'">
                                        <label class="custom-label">Motivo de devolución:</label>
                                        <textarea class="custom-input limited-textarea" rows="1"
                                            placeholder="Ingrese el motivo de devolución"
                                            [(ngModel)]="cabecera.cabSolCotMtovioDev"
                                            [appSecureDisable]="estadoSol"></textarea>
                                    </div>
                                </div>
                            </div>
    
    
                        </div> -->
                    </div>

                    <div class="detalle" *ngIf="actionEdit == 'edicion'">
                        <table class="table table-striped text-center">
                            <thead>
                                <tr>
                                    <th scope="col">Item</th>
                                    <th scope="col" style="width: 450px;">Descripción*</th>
                                    <!-- PRESUPUESTO -->
                                    <ng-container *ngIf="!isDim">
                                        <th scope="col">Presupuesto*</th>
                                    </ng-container>



                                    <th scope="col">Sector*</th>
                                    <th scope="col">Unidad</th>
                                    <th scope="col">Cantidad Total</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr *ngIf="item.length == 0">
                                    <td class="text-danger" colspan="6">
                                        No se han registrado items para esta solicitud
                                    </td>
                                </tr>
                                <tr *ngFor="let det of detalle; let i = index">
                                    <td class="align-middle">{{ i+1 }}</td>
                                    <td class="align-middle">
                                        <!-- <input type="text" class="form-control" [(ngModel)]="det.solCotDescripcion"></td> -->
                                        <textarea name="descripcion" class="form-control  limited-textarea" rows="2"
                                            cols="15" placeholder="Descripción" [(ngModel)]="det.solCotDescripcion"
                                            [appSecureDisable]="estadoSol"></textarea>
                                    </td>
                                    <!-- PRESUPUESTO -->
                                    <ng-container *ngIf="!isDim">
                                        <td class="align-middle">
                                            <select class="form-control" [(ngModel)]="det.solCotPresupuesto"
                                                [appSecureDisable]="estadoSol">
                                                <option value="" selected disabled>presupuesto...</option>
                                                <option *ngFor="let prep of presupuestos" [value]="prep.prespId">
                                                    {{prep.prespNombre}}</option>
                                            </select>
                                        </td>
                                    </ng-container>

                                    <td class="align-middle"><button class="primary-button-outline"
                                            (click)="selectDet(det)" data-toggle="modal"
                                            data-target="#itemsectorEdit">Ver
                                            Desglose</button></td>
                                    <td class="align-middle">
                                        <select class="form-control" [(ngModel)]="det.solCotUnidad"
                                            [appSecureDisable]="estadoSol">
                                            <option value="Unidad">Unidad</option>
                                            <option value="Sacos">Sacos</option>
                                            <option value="Paquete">Paquete</option>
                                            <option value="Avance de Obra">Avance de Obra</option>
                                            <option value="Millar">Millar</option>
                                            <option value="Metros">Metros</option>
                                            <option value="Kilos">Kilos</option>
                                            <option value="Gramos">Gramos</option>
                                            <option value="Caneca">Caneca</option>
                                            <option value="Galon">Galón</option>
                                        </select>
                                    </td>
                                    <td class="align-middle">
                                        {{ det.solCotCantidadTotal }}
                                        <button class="btn text-danger btn-border"
                                            (click)="confDeleteDet(det.solCotID, det.solCotIdDetalle)"
                                            data-toggle="modal" data-target="#dltDetSaved" *appAuthorize="'66'"
                                            [appSecureDisable]="estadoSol">
                                            <i class="bi bi-x-circle"></i>
                                        </button>
                                    </td>
                                </tr>

                                <tr *appAuthorize="'66'">
                                    <th class="align-middle">{{ det_id }}</th>
                                    <td class="align-middle">
                                        <textarea name="descripcion" class="form-control  limited-textarea" rows="2"
                                            cols="10" placeholder="Descripción" [(ngModel)]="det_descp"
                                            [appSecureDisable]="estadoSol"></textarea>
                                    </td>
                                    <!-- PRESUPUESTO -->
                                    <ng-container *ngIf="!isDim">
                                        <td class="align-middle">
                                            <select class="form-control" [(ngModel)]="det_presupuesto"
                                                [appSecureDisable]="estadoSol">
                                                <option value="0" selected disabled>presupuesto...</option>
                                                <option *ngFor="let prep of presupuestos" [value]="prep.prespId">
                                                    {{prep.prespNombre}}</option>
                                            </select>
                                        </td>
                                    </ng-container>
                                    <td class="align-middle">
                                        <button class="primary-button-outline" data-toggle="modal"
                                            data-target="#itemsector" [disabled]="!det_descp" (click)="openModalItem()"
                                            [appSecureDisable]="estadoSol">
                                            Desglose
                                        </button>
                                    </td>
                                    <td class="align-middle" style="width: 150px">
                                        <select class="form-control" [(ngModel)]="det_unidad"
                                            [appSecureDisable]="estadoSol">
                                            <option value="Unidad" selected>Unidad</option>
                                            <option value="Sacos">Sacos</option>
                                            <option value="Paquete">Paquete</option>
                                            <option value="Avance de Obra">Avance de Obra</option>
                                            <option value="Millar">Millar</option>
                                            <option value="Metros">Metros</option>
                                            <option value="Kilos">Kilos</option>
                                            <option value="Gramos">Gramos</option>
                                            <option value="Caneca">Caneca</option>
                                            <option value="Galon">Galón</option>
                                        </select>
                                    </td>
                                    <td class="align-middle cel-prep">
                                        <input type="text" class="form-control text-center" [(ngModel)]="det_cantidad"
                                            disabled />
                                    </td>
                                </tr>
                                <tr *appAuthorize="'66'">
                                    <ng-container *ngIf="det_descp && det_cantidad != 0">
                                        <td colspan="6" class="align-middle text-end">
                                            <button class="btn btn-success"
                                                [disabled]="!det_descp || tmpItemSect.length === 0"
                                                (click)="addDetalle()" [appSecureDisable]="estadoSol">
                                                <i class="bi bi-check"></i>
                                            </button>
                                        </td>
                                    </ng-container>
                                </tr>
                            </tbody>
                        </table>
                    </div>

                    <div *ngIf="actionEdit == 'proveedores'">
                        <app-cot-proveedores [cabSolCotAsunto]="cabSolCotAsunto" [mail_detalles]="sharedDetalle"
                            [tipoSol]="sharedTipoSol" [noSol]="sharedNoSol"
                            [estadoSol]="estadoSol"></app-cot-proveedores>
                    </div>

                    <div *ngIf="actionEdit == 'documentacion'">
                        <app-cot-documentacion [tipoSol]="sharedTipoSol" [noSol]="sharedNoSol"
                            [estadoSol]="estadoSol"></app-cot-documentacion>
                    </div>

                    <div *ngIf="actionEdit == 'autorizacion' && checkAprovePermission()">
                        <div class="anulacion mb-3">
                            <div class="m-2">
                                <h2>Autorización de solicitud</h2>
                                <div class="text-center">
                                    <div class="row buttons-ruteo">
                                        <ng-container *appAuthorize="'54'">
                                            <button *ngIf="setMotivo == 'NO' && estadoSol == lastNivel"
                                                class="btn btn-success col m-2" data-toggle="modal"
                                                data-target="#aprobarSolicitud"
                                                [appSecureDisable]="estadoSol">Finalizar</button>
                                            <button *ngIf="setMotivo == 'NO' && estadoSol != lastNivel"
                                                class="btn btn-success col m-2" data-toggle="modal"
                                                data-target="#aprobarSolicitud"
                                                [appSecureDisable]="estadoSol">Aprobar</button>
                                        </ng-container>
                                        <button *appAuthorize="'57'" class="btn btn-warning col m-2" data-toggle="modal"
                                            data-target="#rechazarSolicitud"
                                            [appSecureDisable]="estadoSol">Devolver</button>
                                        <button *appAuthorize="'60'" class="btn btn-danger col m-2" data-toggle="modal"
                                            data-target="#anularSolicitud"
                                            [appSecureDisable]="estadoSol">Anular</button>
                                    </div>
                                    <div class="sin-presp" *appAuthorize="'78'">
                                        <p>Falta de presupuesto</p>
                                        <mat-slide-toggle color="primary" [checked]="checkedToggle"
                                            (change)="changeToggleButton($event)"></mat-slide-toggle>
                                    </div>
                                </div>
                            </div>
                        </div>
                        <!-- <app-cot-anulacion [tipoSol]="sharedTipoSol" [noSol]="sharedNoSol"
                            [estadoSol]="estadoSol" [setMotivo]="setMotivo"></app-cot-anulacion> -->
                    </div>
                    <div *ngIf="actionEdit == 'autorizacion' && !checkAprovePermission()"
                        style="display:flex;  align-items: center; ">
                        <mat-card style="background-color: rgb(255,0,0,0.5); color: white; margin: 0 auto; ">
                            <mat-card-content>Su usuario no está autorizado para realizar esta
                                transacción</mat-card-content>
                        </mat-card>
                    </div>

                    <div class="foot-cabecera">
                        <div class=" mb-3">
                            <label for="floatingInput" style="color: rgba(0, 0, 0, 0.5);">Materiales y procedimientos a
                                seguir:</label>
                            <textarea style="max-height: 300px;" class="form-control" id="floatingInput" rows="5"
                                [(ngModel)]="cabecera.cabSolCotProcedimiento" [appSecureDisable]="estadoSol"
                                placeholder=""></textarea>
                        </div>
                        <div class=" mb-3">
                            <label for="floatingInput" style="color: rgba(0, 0, 0, 0.5);">Observaciones:</label>
                            <textarea style="max-height: 300px;" class="form-control" id="floatingInput" rows="5"
                                [(ngModel)]="cabecera.cabSolCotObervaciones" [appSecureDisable]="estadoSol"
                                placeholder=""></textarea>
                        </div>

                        <div class="input-group mb-3">
                            <label class="input-group-text">Adjunto cotizaciones:</label>
                            <select class="form-control" [(ngModel)]="cabecera.cabSolCotAdjCot"
                                [appSecureDisable]="estadoSol">
                                <option value="SI">Sí</option>
                                <option value="NO" selected>No</option>
                            </select>
                            <label class="input-group-text">Número de cotizaciones:</label>
                            <input class="form-control" type="number" (input)="validarNumero($event)" min="1"
                                [(ngModel)]="cabecera.cabSolCotNumCotizacion" [appSecureDisable]="estadoSol" />
                        </div>
                        <div class="input-group mb-3">
                            <label class="input-group-text">Plazo de entrega:</label>
                            <input class="form-control" type="date" for="plazoentrega"
                                [(ngModel)]="cabecera.cabSolCotPlazoEntrega" [appSecureDisable]="estadoSol" />
                            <label class="input-group-text">Fecha máxima de entrega:</label>
                            <input class="form-control" type="date" for="fechamaxima"
                                [(ngModel)]="cabecera.cabSolCotFechaMaxentrega" [appSecureDisable]="estadoSol" />
                        </div>
                        <div class="input-group mb-1">
                            <label class="input-group-text">Inspector:</label>
                            <input type="text" class="form-control" id="busqueda" list="inspectores"
                                [(ngModel)]="nameInspector" (keyup)="searchInspectorEdit()"
                                [appSecureDisable]="estadoSol" />
                            <datalist id="inspectores">
                                <ng-container *ngFor="let empOP of inspectoresEdit">
                                    <option [value]="empOP.empleadoNombres + ' ' + empOP.empleadoApellidos"></option>
                                </ng-container>
                            </datalist>
                            <label class="input-group-text">Teléfono:</label>
                            <input class="form-control" type="text" [(ngModel)]="cabecera.cabSolCotTelefInspector"
                                [appSecureDisable]="estadoSol" />
                        </div>
                        <div class="row justify-content-between ">
                            <app-cot-pdf class="text-end"></app-cot-pdf>
                        </div>
                    </div>
                </div>
                <div class="d-flex row mt-2">
                    <div class="col">
                        <!-- <div *ngIf="showmsj" class="alert alert-success" role="alert">
                            <span><i class="bi bi-check-circle-fill"> {{ msjExito }}</i></span>
                        </div>
                        <div *ngIf="showmsjerror" class="alert alert-danger" role="alert">
                            <span><i class="bi bi-exclamation-triangle-fill">
                                    {{ msjError }}</i></span>
                        </div> -->
                    </div>
                    <div class="col text-end">
                        <ng-container *ngIf="cabecera.cabSolCotEstadoTracking == 10">
                            <button mat-raised-button class="primary-button m-2" data-toggle="modal"
                                data-target="#guardarEdicion" (click)="saveIdInspector()"
                                [appSecureDisable]="estadoSol">Guardar</button>
                            <button mat-raised-button class="success-button m-2" data-toggle="modal"
                                data-target="#enviarSolicitudGuardada" [appSecureDisable]="estadoSol"
                                *appAuthorize="'27'">
                                Guardar y enviar
                            </button>
                        </ng-container>
                        <button mat-raised-button *ngIf="cabecera.cabSolCotEstadoTracking == 10" class="danger-button"
                            data-toggle="modal" data-target="#deleteCoti" [appSecureDisable]="estadoSol">Eliminar
                            solicitud</button>
                        <button mat-raised-button class="danger-button m-2" (click)="cancelar()">Cancelar</button>
                    </div>
                </div>
            </ng-container>


        </div>
    </ng-container>
</div>

<!-- Modal para los items por sector-->
<div class="modal fade" #exampleModal id="itemsectorview" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    Ingrese los items según el sector
                </h3>
            </div>
            <div class="modal-body">
                <table class="table table-striped text-center justify-content-center">
                    <thead>
                        <tr>
                            <th scope="col">N° Detalle</th>
                            <th scope="col">Descripción</th>
                            <th scope="col">N° Item</th>
                            <th scope="col">Cantidad*</th>
                            <th scope="col" colspan="2">Sector*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngIf="itemSectorList.length != 0">
                            <th colspan="6">Items Registrados</th>
                        </tr>
                        <tr *ngFor="let item of itemSectorList">
                            <ng-container *ngIf="item.det_id == IdDetalleEdicion">
                                <td class="align-middle">{{ item.det_id }}</td>
                                <td class="align-middle">{{ item.det_descp }}</td>
                                <td class="align-middle">{{ item.item_id }}</td>
                                <td class="align-middle"><input type="number" (input)="validarNumeroFloat($event)"
                                        min="1" class="form-control" name="item_cant" [(ngModel)]="item.item_cant"></td>


                                <!-- <td class="align-middle">
                                {{ item.item_sector
                                }}<button class="btn text-danger" (click)="deleteItem(item.item_id)">
                                    <i class="bi bi-x-circle"></i>
                                </button>
                            </td> -->
                                <ng-container *ngFor="let sect of sectores$ | async">
                                    <!-- <td *ngIf="sect.sectIdNomina == item.item_sector" class="align-middle">
                                    {{ sect.sectNombre }}
                                </td> -->
                                    <td *ngIf="sect.sectIdNomina == item.item_sector" class="align-middle">
                                        <select class="form-select" name="item_sector" [(ngModel)]="item.item_sector">
                                            <option selected disabled value="0">Selecciona un sector...</option>
                                            <option *ngFor="let sect of sectores$ | async" [value]="sect.sectIdNomina">
                                                {{ sect.sectNombre }}</option>
                                        </select>
                                    </td>
                                </ng-container>
                                <!-- <td>
                                    <button class="btn text-danger"  data-toggle="modal" data-target="#dltItemView" (click)="deleteview(item.item_id, item.det_id)">
                                        <i class="bi bi-x-circle"></i></button>
                                </td> -->
                            </ng-container>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal" (click)="calculardetalleview()">
                    Aceptar
                </button>
            </div>
        </div>
    </div>
</div>
<div class="modal fade" #exampleModal id="dltItemView" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea eliminar este item?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="deleteViewSave()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para los items por sector-->
<div class="modal fade" #exampleModal id="itemsector" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    Ingrese los items según el sector
                </h3>
            </div>
            <div class="modal-body">
                <table class="table table-striped text-center justify-content-center">
                    <thead>
                        <tr>
                            <th scope="col">N° Detalle</th>
                            <th scope="col">Descripción</th>
                            <th scope="col">N° Item</th>
                            <th scope="col">Cantidad*</th>
                            <th scope="col" colspan="2">Sector*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngIf="tmpItemSect.length != 0">
                            <th colspan="6">Items Registrados</th>
                        </tr>
                        <tr *ngFor="let item of tmpItemSect">
                            <td class="align-middle">{{ item.det_id }}</td>
                            <td class="align-middle">{{ item.det_descp }}</td>
                            <td class="align-middle">{{ item.item_id }}</td>
                            <td class="align-middle">{{ item.item_cant }}</td>
                            <!-- <td class="align-middle">
                                {{ item.item_sector
                                }}<button class="btn text-danger" (click)="deleteItem(item.item_id)">
                                    <i class="bi bi-x-circle"></i>
                                </button>
                            </td> -->
                            <ng-container *ngFor="let sect of sectores$ | async">
                                <td *ngIf="sect.sectIdNomina == item.item_sector" class="align-middle">
                                    {{ sect.sectNombre }}
                                </td>
                            </ng-container>
                            <td>
                                <button class="btn text-danger" (click)="deleteItem(item.item_id)">
                                    <i class="bi bi-x-circle"></i></button>
                            </td>
                        </tr>
                        <tr>
                            <th colspan="6">Registrar un nuevo item</th>
                        </tr>
                        <tr>
                            <td class="align-middle">{{ det_id }}</td>
                            <td class="align-middle">
                                <input class="form-control" type="text" value="Descripción" [(ngModel)]="det_descp"
                                    placeholder="Descripción" disabled />
                            </td>
                            <td class="align-middle cel-prep">
                                <input type="text" class="form-control text-center" [(ngModel)]="item_id" disabled />
                            </td>
                            <td class="align-middle">
                                <div class="cel-prep">
                                    <input class="form-control" [(ngModel)]="item_cant"
                                        (input)="validarNumeroFloat($event)" min="1" type="number"
                                        placeholder="Cantidad" />
                                </div>
                            </td>
                            <td class="align-middle" style="width: 150px" colspan="2">
                                <div class="cel-prep">
                                    <select class="form-select" name="item_sector" [(ngModel)]="item_sector">
                                        <option selected disabled value="0">
                                            Selecciona un sector...
                                        </option>
                                        <option *ngFor="let sect of sectores$ | async" [value]="sect.sectIdNomina">
                                            {{ sect.sectNombre }}
                                        </option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr>
                            <td colspan="6" class="align-middle text-end">
                                <button class="btn btn-success" [disabled]="!item_sector" (click)="addItemSector()">
                                    <i class="bi bi-check"></i>
                                </button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal"
                    [disabled]="tmpItemSect.length === 0">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal" (click)="cancelarItem()">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Modal para editar los items-->
<div class="modal fade" #exampleModal id="itemsectorEdit" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered modal-lg" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    Editar items segun el sector
                </h3>
            </div>
            <div class="modal-body">
                <table class="table table-striped text-center justify-content-center">
                    <thead>
                        <tr>
                            <th scope="col">N° Detalle</th>
                            <th scope="col">Descripción</th>
                            <th scope="col">N° Item</th>
                            <th scope="col">Cantidad*</th>
                            <th scope="col" colspan="2">Sector*</th>
                        </tr>
                    </thead>
                    <tbody>
                        <tr *ngIf="item.length != 0">
                            <th colspan="6">Items Registrados</th>
                        </tr>
                        <tr *ngFor="let itm of item; let i = index">
                            <ng-container *ngIf="idDetEdit == itm.itmIdDetalle">
                                <th class="align-middle">{{ itm.itmIdDetalle }}</th>
                                <ng-container *ngFor="let detd of detalle; let d = index">
                                    <td *ngIf="detd.solCotIdDetalle == itm.itmIdDetalle" class="align-middle">
                                        <input type="text" class="form-control" [value]="detd.solCotDescripcion"
                                            disabled>
                                    </td>
                                </ng-container>
                                <td class="align-middle">{{ itm.itmIdItem }}</td>
                                <td class="align-middle">{{ itm.itmCantidad }}</td>
                                <!-- <ng-container *ngFor="let detu of detalle; let d = index">
                                    <td *ngIf="detu.solCotIdDetalle == itm.itmIdDetalle" class="align-middle">
                                        {{ detu.solCotUnidad }}
                                    </td>
                                </ng-container> -->
                                <ng-container *ngFor="let sect of sectores$ | async">
                                    <td *ngIf="sect.sectIdNomina == itm.itmSector" class="align-middle">
                                        {{ sect.sectNombre }}
                                    </td>
                                </ng-container>
                                <td *ngIf="showEdicionItem"><!-- Aqui hay que controlar que no se muestre en edicion -->
                                    <button class="btn text-danger" data-toggle="modal" data-target="#dltItemSaved"
                                        (click)="confDeleteItm(itm.itmID, itm.itmIdItem, itm.itmNumSol)">
                                        <i class="bi bi-x-circle"></i></button>
                                </td>
                            </ng-container>

                        </tr>
                        <tr>
                            <th colspan="6">Registrar un nuevo item</th>
                        </tr>
                        <tr *appAuthorize="'66'"><!-- Aqui hay que controlar que no se muestre en edicion -->
                            <td class="align-middle">{{ det_id_edit }}</td>
                            <td class="align-middle">
                                <input class="form-control" type="text" value="Descripción" [(ngModel)]="det_descp_edit"
                                    placeholder="Descripción" disabled />
                            </td>
                            <td class="align-middle cel-prep">
                                <input type="text" class="form-control text-center" [(ngModel)]="item_id" disabled />
                            </td>
                            <td class="align-middle">
                                <div class="cel-prep">
                                    <input class="form-control" [(ngModel)]="item_cant" min="1" type="number"
                                        placeholder="Cantidad" [appSecureDisable]="estadoSol" />
                                </div>
                            </td>
                            <td class="align-middle" style="width: 150px" colspan="2">
                                <div class="cel-prep">
                                    <select class="form-select" name="item_sector" [(ngModel)]="item_sector"
                                        [appSecureDisable]="estadoSol">
                                        <option *ngFor="let sect of sectores$ | async" [value]="sect.sectIdNomina">
                                            {{ sect.sectNombre }}
                                        </option>
                                    </select>
                                </div>
                            </td>
                        </tr>
                        <tr *appAuthorize="'66'"><!-- Aqui hay que controlar que no se muestre en edicion -->
                            <td colspan="6" class="align-middle text-end">
                                <button class="btn btn-success" (click)="addNewItem()" [appSecureDisable]="estadoSol">
                                    <i class="bi bi-check"></i></button>
                            </td>
                        </tr>
                    </tbody>
                </table>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-success" data-dismiss="modal" (click)="cancelarItem()">
                    Confirmar
                </button>
            </div>
        </div>
    </div>
</div>

<!--Modal para guardar edicion de solicitud  -->
<div class="modal fade" #exampleModal id="guardarCotizacion" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea guardar esta solicitud?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción guardará los datos ingresados en la solicitud pero no la enviará para su revisón.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="check()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!--Modal para guardar edicion de solicitud  -->
<div class="modal fade" #exampleModal id="guardarEdicion" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea guardar los cambios realizados en la solicitud?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción guardará los cambios hechos en la solicitud pero no enviará la solicitud.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="saveEdit()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para confirmar eliminacion de item-->
<div class="modal fade" #exampleModal id="dltItemSaved" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea eliminar este item?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="deleteItemSaved()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>
<!-- Modal para eliminar Cotizacion-->
<div class="modal fade" #exampleModal id="deleteCoti" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea eliminar esta Solicitud de Cotización?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción eliminará esta solicitud y ya no podrá acceder a ella.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="EliminarCotiza(cabecera.cabSolCotTipoSolicitud
                ,cabecera.cabSolCotNoSolicitud)">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para confirmar eliminacion de detalle-->
<div class="modal fade" #exampleModal id="dltDetSaved" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea eliminar este detalle?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción no se puede deshacer.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="deleteDetSaved()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Modal para verificar el envío de la soliitud recien registrada-->
<div class="modal fade" #exampleModal id="enviarSolicitud" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea guardar la solicitud y enviarla para su revisión?
                </h3>
            </div>
            <div class="modal-body">
                <p>Al enviar la solicitud no podrá volver a editarla y pasará al siguiente estado.</p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="guardarEnviarSolNueva()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para verificar el envío de la solcitud guardada-->
<div class="modal fade" #exampleModal id="enviarSolicitudGuardada" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea guardar los cambios realizados en la solicitud y enviarla para su revisión?
                </h3>
            </div>
            <div class="modal-body">
                <p>Esta acción guardará los cambios hechos en la solicitud y enviará la solicitud a su siguiente estado.
                </p>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="guardarEnviarSolEditada()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para verificar el envío de la solicitud recien registrada-->
<div class="modal fade" #exampleModal id="aprobarSolicitud" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea enviar esta solicitud?
                </h3>
            </div>
            <div class="modal-body">
                <p>Al enviar la solicitud no podrá volver a editarla y pasará al siguiente nivel.</p>
                <ng-container *ngIf="estadoSol == '50'">
                    <ng-container> <!-- *appAuthorize="'67'" NUMERO DE TRANSACCIÓN -->
                        <p>Por favor ingrese el número de orden de compra y el valor de la solicitud:</p>
                        <div style="background-color: #acacac; border-radius: 5px; padding: 10px;">
                            <div class="custom-input-group" style="margin-bottom: 10px;">
                                <label class="custom-label">Número de OC:</label>
                                <input type="text" class="custom-input" [(ngModel)]="serviceGlobal.solOC" />
                            </div>
                            <div class="custom-input-group">
                                <label class="custom-label">Valor de la Solicitud:</label>
                                <input type="number" class="custom-input" [(ngModel)]="serviceGlobal.solValor" />
                            </div>
                        </div>
                    </ng-container>
                </ng-container>
            </div>
            <div class="modal-footer">
                <!-- <button *appAuthorize="'67'" type="button" class="btn btn-warning" data-dismiss="modal" 
                [disabled]="!checkNewVersion()" (click)="guardarEnviarSolEditada()">
                    Guardar y confirmar
                </button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" [disabled]="!checkNewVersion()" (click)="enviarSolicitud()">
                    Confirmar
                </button> -->
                <button *appAuthorize="'67'" type="button" class="btn btn-warning" data-dismiss="modal"
                    (click)="guardarEnviarSolEditada()">
                    Guardar y confirmar
                </button>
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="enviarSolicitud()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>

<!-- Modal para verificar el envío de la soliitud recien registrada-->
<div class="modal fade" #exampleModal id="rechazarSolicitud" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea no autorizar esta solicitud?
                </h3>
            </div>
            <div class="modal-body">
                <p>Al no autorizar la solicitud, esta se regresará al nivel anterior para su revisión.</p>
                <div>
                    <input type="checkbox" [(ngModel)]="showMotivoDev">
                    <label for="devolucion">Asignar motivo de la devolución:</label>
                    <p class="text-danger font-italic">Advertencia: si la solicitud ya posee un motivo asignado, no lo
                        debe modificar.</p>
                    <textarea class="form-control" name="devolucion" cols="30" rows="5" [(ngModel)]="motivoDevEditar"
                        [disabled]="!showMotivoDev"></textarea>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal"
                    (click)="guardarDevolverSolEditada()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>


<!-- Modal para verificar el envío de la soliitud recien registrada-->
<div class="modal fade" #exampleModal id="anularSolicitud" data-backdrop="static" tabindex="-1" role="dialog"
    aria-labelledby="exampleModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-dialog-centered" role="document">
        <div class="modal-content">
            <div class="modal-header justify-content-center">
                <h3 class="font-weight-bold" id="exampleModalLabel">
                    ¿Está seguro que desea anular esta solicitud?
                </h3>
            </div>
            <div class="modal-body">
                <p>Al anular la solicitud, esta tendrá el estado ANULADO y el proceso quedará finalizado.</p>

            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-primary" data-dismiss="modal" (click)="anularSolicitud()">
                    Confirmar
                </button>
                <button type="button" class="btn btn-danger" data-dismiss="modal">
                    Cancelar
                </button>
            </div>
        </div>
    </div>
</div>